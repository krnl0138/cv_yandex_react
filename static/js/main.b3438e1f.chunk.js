(this["webpackJsonpreact-burger"]=this["webpackJsonpreact-burger"]||[]).push([[0],{110:function(e,t,n){e.exports={main:"routes_main__2P4mw"}},112:function(e,t,n){e.exports={item:"burger-constructor-middle_item__29c3C"}},114:function(e,t,n){},115:function(e,t,n){e.exports={modalOverlay:"modal-overlay_modalOverlay__2mRqa"}},116:function(e,t,n){e.exports={main:"page-not-found_main__2YHyb"}},128:function(e,t,n){},15:function(e,t,n){e.exports={header:"app-header_header__14Ifc",nav:"app-header_nav__2K0EQ",nav_element:"app-header_nav_element__2K7B_",nav_element_left:"app-header_nav_element_left__1giBE",nav_element_right:"app-header_nav_element_right__XYGN_",center:"app-header_center__gAlLp",link:"app-header_link__zAPNr",activeLink:"app-header_activeLink__2BwNZ",burger:"app-header_burger__2QbC0"}},16:function(e,t,n){e.exports={main:"order-view_main__1ejcS",mainModal:"order-view_mainModal__1miOG",row:"order-view_row__IeGX7",orderNumber:"order-view_orderNumber__WKeqt",orderIngredients:"order-view_orderIngredients__3GmKU",orderIngredientRow:"order-view_orderIngredientRow__qcHn4",ingIcon:"order-view_ingIcon__177A7",ingIconSpan:"order-view_ingIconSpan__1foWG",ingValue:"order-view_ingValue__1kpxv",orderValue:"order-view_orderValue__1R7kX",statusDone:"order-view_statusDone__OhG6v",statusCancelled:"order-view_statusCancelled__2RCM9",statusInProcess:"order-view_statusInProcess__3GwxQ"}},216:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(40),s=n.n(c),i=(n(128),n(15)),o=n.n(i),l=n(4),d=n(7),u=n(0);function m(){return Object(u.jsx)("header",{className:"".concat(o.a.header,"\n                    text text_type_main-small text_color_inactive \n                    pt-2 pb-2 pl-8 pr-8"),children:Object(u.jsxs)("nav",{className:o.a.nav,children:[Object(u.jsxs)(d.c,{exact:!0,to:{pathname:"/"},activeClassName:o.a.activeLink,className:"".concat(o.a.nav_element," pt-2 pb-2 pl-5 pr-5 ").concat(o.a.link),children:[Object(u.jsx)(l.BurgerIcon,{type:"secondary"}),Object(u.jsx)("p",{className:"".concat(o.a.app_header_button," ml-2"),children:"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440"})]}),Object(u.jsxs)(d.c,{exact:!0,to:{pathname:"/feed"},activeClassName:o.a.activeLink,className:"".concat(o.a.nav_element," pt-2 pb-2 pl-5 pr-5 ").concat(o.a.link),children:[Object(u.jsx)(l.ListIcon,{type:"secondary"}),Object(u.jsx)("p",{className:"".concat(o.a.app_header_button," ml-2"),children:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"})]}),Object(u.jsx)("span",{className:o.a.center,children:Object(u.jsx)(d.b,{to:{pathname:"/"},children:Object(u.jsx)(l.Logo,{})})}),Object(u.jsxs)("div",{className:"".concat(o.a.nav_element," ").concat(o.a.nav_element_right," pt-2 pb-2 pl-5 pr-5"),children:[Object(u.jsx)(l.ProfileIcon,{type:"secondary"}),Object(u.jsx)(d.c,{to:{pathname:"/profile"},activeClassName:o.a.activeLink,className:"text text_type_main-small text-color-inactive ml-2 ".concat(o.a.link),children:"\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442"})]})]})})}var j=n(110),p=n.n(j),b=n(221),_=n(122),f=n(11),O=n(48),h=O.c,x=function(){return Object(O.b)()},v=n(12),g=n(6),y=n.n(g);function N(e,t,n){var r=(n=n||{}).expires;if("number"==typeof r&&r){var a=new Date;a.setTime(a.getTime()+1e3*r),r=n.expires=a}r instanceof Date&&r.toUTCString&&(n.expires=r.toUTCString());var c=e+"="+(t=encodeURIComponent(t));for(var s in n){c+="; "+s;var i=n[s];!0!==i&&(c+="="+i)}document.cookie=c}function E(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}var T="wss://norma.nomoreparties.space/orders",S=T+"?token="+E("accessToken"),C=function(e){return e.ok?e.json():Promise.reject("Error ".concat(e.status))},w=function(){var e=Object(v.a)(y.a.mark((function e(){var t,n,r,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("refreshToken"),n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t})},console.log("PROCEED TO REFRESH_TOKEN"),e.prev=3,e.next=6,fetch("https://norma.nomoreparties.space/api/auth/token",n);case 6:return r=e.sent,e.next=9,C(r);case 9:N("accessToken",(a=e.sent).accessToken.split("Bearer ")[1]),localStorage.setItem("refreshToken",a.refreshToken),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=Object(v.a)(y.a.mark((function e(t,n){var r,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,n);case 3:return r=e.sent,e.next=6,C(r);case 6:case 19:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),e.next=13,w();case 13:return console.log("after refresh token"),e.next=16,fetch(t,{method:n.method,headers:{"Content-Type":"application/json",Authorization:"Bearer "+E("accessToken")}});case 16:return a=e.sent,e.next=19,C(a);case 20:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}(),R="GET_INGREDIENTS_REQUEST",k="GET_INGREDIENTS_REQUEST_SUCCESS",D="GET_INGREDIENTS_REQUEST_ERROR",A="USER_SET_CREDENTIALS",L="USER_LOGOUT",U=function(){return function(){var e=Object(v.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"GET_USER_DATA_REQUEST"}),n={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+E("accessToken")}},console.log("proceed to GET user info"),e.next=5,I("https://norma.nomoreparties.space/api/auth/user",n).then((function(e){t({type:A,user:e.user}),t({type:"GET_USER_DATA_REQUEST_SUCCESS"})})).catch((function(e){t({type:"GET_USER_DATA_REQUEST_FAILED"}),console.error(e)}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},G=n(5),P=n(20),B=n(36),Q=n.n(B),F=n(223),z="ADD_CART_INGREDIENT",W="ADD_CART_INGREDIENT_BUN",M="DELETE_CART_INGREDIENT",V="MOVE_CART_INGREDIENT",H="CLEAR_CART_INGREDIENT",J="POST_ORDER_REQUEST",q="POST_ORDER_SUCCESS",K="POST_ORDER_FAILED",X="GET_ORDER_REQUEST",Y="GET_ORDER_SUCCESS",Z="GET_ORDER_FAILED",$="RESET_ORDER_NUMBER",ee="VISIBLE_ORDER_DETAILS",te="VISIBLE_INGREDIENT_DETAILS",ne="VISIBLE_ORDERS_DETAILS",re=n(112),ae=n.n(re),ce=n(222);function se(e){var t=e.item,n=e.index,r=x(),a=Object(ce.a)({type:"move",item:function(){return{item:t,index:n}},collect:function(e){return{opacity:e.isDragging()?.5:1}}}),c=Object(G.a)(a,2),s=c[0].opacity,i=c[1],o=Object(F.a)({accept:"move",drop:function(e){r({type:V,ingredient:e,dropIndex:n})},collect:function(e){return{paddingLeft:e.isOver()?30:0}}}),d=Object(G.a)(o,2),m=d[0].paddingLeft,j=d[1];return Object(u.jsx)("div",{ref:i,style:{opacity:s},children:Object(u.jsx)("div",{ref:j,style:{paddingLeft:m},children:Object(u.jsxs)("span",{className:"".concat(ae.a.item," ml-2 mr-6 mt-2 mb-2"),children:[Object(u.jsx)(l.DragIcon,{type:"primary"}),Object(u.jsx)(l.ConstructorElement,{text:t.name,price:t.price,thumbnail:t.image,handleClose:function(){return function(e){r({type:M,ingredientIndex:e})}(n)}})]})})})}var ie=n(114),oe=n.n(ie);function le(e){var t=e.bun,n=e.type,r=e.bunDropRef;return t?Object(u.jsx)("div",{ref:r,className:oe.a.bun,children:Object(u.jsx)(l.ConstructorElement,{type:n,isLocked:!0,text:"".concat(t.name," ").concat("top"===n?"(\u0432\u0435\u0440\u0445)":"(\u043d\u0438\u0437)"),thumbnail:t.image,price:t.price})}):Object(u.jsx)("div",{ref:r,className:"ml-8 mr-8",children:Object(u.jsx)(l.ConstructorElement,{type:n,isLocked:!0,text:"",thumbnail:"https://cdn-icons-png.flaticon.com/128/1/1601.png",price:0})})}function de(){var e=x(),t=Object(f.g)(),n=Object(f.h)(),r=h((function(e){return e.user})),a=h((function(e){return e.cart.\u0441artIngredients})),c=a.map((function(e){return e._id})),s=h((function(e){return e.cart.bunIngredients[0]})),i=s?[s,s].concat(Object(P.a)(a)).reduce((function(e,t){return e+t.price}),0):a.reduce((function(e,t){return e+t.price}),0),o=Object(F.a)({accept:"ingredient",drop:function(t){e({type:z,ingredient:t})}}),d=Object(G.a)(o,2)[1],m=Object(F.a)({accept:"bun",drop:function(t){e({type:W,ingredient:t})}}),j=Object(G.a)(m,2)[1],p=Object(F.a)({accept:"bun",drop:function(t){e({type:W,ingredient:t})}}),b=Object(G.a)(p,2)[1];return Object(u.jsxs)("section",{className:"".concat(Q.a.main," mt-25 mr-10"),children:[Object(u.jsxs)("div",{className:"".concat(Q.a.constructor," mb-4"),children:[Object(u.jsx)(le,{bun:s,type:"top",bunDropRef:j}),Object(u.jsx)("div",{className:Q.a.middle,ref:d,children:a.map((function(e,t){return Object(u.jsx)("div",{className:Q.a.middleIngredients,children:Object(u.jsx)(se,{item:e,index:t})},"".concat(e._id).concat(t))}))}),Object(u.jsx)(le,{bun:s,type:"bottom",bunDropRef:b})]}),Object(u.jsxs)("div",{className:Q.a.orderSection,children:[Object(u.jsxs)("span",{className:"".concat(Q.a.price," m-5"),children:[Object(u.jsx)("p",{className:"text text_type_digits-medium mr-2",children:i}),Object(u.jsx)(l.CurrencyIcon,{type:"primary"})]}),Object(u.jsx)(l.Button,{type:"primary",size:"medium",onClick:function(){if(!r.username)return t.push({pathname:"/login"});s&&0!==a.length&&(e({type:ee,value:!0}),e(function(e){return function(t){t({type:J}),fetch("https://norma.nomoreparties.space/api/orders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+E("accessToken")},body:JSON.stringify({ingredients:e})}).then((function(e){return C(e)})).then((function(n){t({type:q,orderNumber:n.order.number,ingredientsIDs:e}),t({type:H})})).catch((function(e){t({type:K}),console.log(e)}))}}(c)),t.replace({pathname:"/",state:{from:n.pathname}}))},children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})]})]})}var ue=n(37),me=n.n(ue),je=n(85),pe=n.n(je);function be(e){var t=e.item,n=e.openDetails,r=h((function(e){return e.cart.\u0441artIngredients})),a=h((function(e){return e.cart.bunIngredients})),c=[].concat(Object(P.a)(r),Object(P.a)(a)).filter((function(e){return e._id===t._id})).length,s=Object(ce.a)({type:"ingredient",item:t,collect:function(e){return{opacity:e.isDragging()?.5:1}}}),i=Object(G.a)(s,2),o=i[0].opacity,d=i[1],m=Object(ce.a)({type:"bun",item:t}),j=Object(G.a)(m,2)[1];return Object(u.jsxs)("div",{ref:"bun"===t.type?j:d,className:"".concat(pe.a.card," pl-2 pr-2"),onClick:n,style:{opacity:o},children:[c>0&&Object(u.jsx)(l.Counter,{count:"bun"===t.type?c+1:c,size:"default"}),Object(u.jsx)("img",{className:"p-2 pb-4",src:t.image,alt:t.name}),Object(u.jsxs)("span",{className:pe.a.price,children:[Object(u.jsx)("p",{className:"text text_type_digits-default mr-2",children:t.price}),Object(u.jsx)(l.CurrencyIcon,{type:"primary"})]}),Object(u.jsx)("p",{className:"text text_type_main-default pb-5 pt-5",style:{fontWeight:700},children:t.name})]},t._id)}var _e=n(86),fe=n.n(_e);function Oe(){return Object(u.jsx)("div",{className:fe.a.main,children:Object(u.jsx)("div",{className:fe.a.loader})})}var he="SET_ACTIVE_INGREDIENT";function xe(){var e=x(),t=Object(f.g)(),n=Object(f.h)(),a=h((function(e){return e.ingredients})),c=a.ingredientsData,s=a.isLoading,i=Object(r.useRef)(null),o=Object(r.useRef)(null),d=Object(r.useRef)(null),m=Object(r.useState)("bun"),j=Object(G.a)(m,2),p=j[0],b=j[1],_=function(e){var t,n,r;b(e),"bun"===e&&(null===(t=i.current)||void 0===t||t.scrollIntoView({behavior:"smooth"})),"sauce"===e&&(null===(n=o.current)||void 0===n||n.scrollIntoView({behavior:"smooth"})),"main"===e&&(null===(r=d.current)||void 0===r||r.scrollIntoView({behavior:"smooth"}))},O=function(r){return c.filter((function(e){return e.type===r})).map((function(r,a){return Object(u.jsx)(be,{item:r,openDetails:function(){e({type:he,activeIngredient:r}),e({type:te,value:!0}),t.push({pathname:"/ingredients/".concat(r._id),state:{background:n}})}},a)}))};return s?Object(u.jsx)(Oe,{}):Object(u.jsxs)("section",{className:"".concat(me.a.main," mr-10 ml-10"),children:[Object(u.jsx)("h2",{className:"text text_type_main-large mt-10 mb-5",children:"\u0421\u043e\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u0440\u0433\u0435\u0440"}),Object(u.jsxs)("div",{className:"".concat(me.a.ingredientsTypeBar," mb-10"),children:[Object(u.jsx)(l.Tab,{value:"bun",active:"bun"===p,onClick:_,children:"\u0411\u0443\u043b\u043a\u0438"}),Object(u.jsx)(l.Tab,{value:"sauce",active:"sauce"===p,onClick:_,children:"\u0421\u043e\u0443\u0441\u044b"}),Object(u.jsx)(l.Tab,{value:"main",active:"main"===p,onClick:_,children:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438"})]}),Object(u.jsxs)("div",{className:me.a.ingredientsTabs,onScroll:function(e){var t,n,r,a=e.currentTarget.scrollTop,c=null===(t=i.current)||void 0===t?void 0:t.getBoundingClientRect().top,s=null===(n=o.current)||void 0===n?void 0:n.getBoundingClientRect().top,l=null===(r=d.current)||void 0===r?void 0:r.getBoundingClientRect().top;a<c&&b("bun"),a>c&&a<s&&b("sauce"),a>l&&b("main")},children:[Object(u.jsx)("p",{className:"text text_type_main-medium mb-5",ref:i,children:"\u0411\u0443\u043b\u043a\u0438"}),Object(u.jsxs)("div",{className:me.a.ingredientsTabsElement,children:[" ",O("bun")," "]}),Object(u.jsx)("p",{className:"text text_type_main-medium mb-5 mt-10",ref:o,children:"\u0421\u043e\u0443\u0441\u044b"}),Object(u.jsxs)("div",{className:me.a.ingredientsTabsElement,children:[" ",O("sauce")," "]}),Object(u.jsx)("p",{className:"text text_type_main-medium mb-5 mt-10",ref:d,children:"\u041d\u0430\u0447\u0438\u043d\u043a\u0430"}),Object(u.jsxs)("div",{className:me.a.ingredientsTabsElement,children:[" ",O("main")," "]})]})]})}var ve=n(62),ge=n.n(ve);function ye(){var e=x(),t=h((function(e){return e.orderDetails})),n=t.orderNumber;return Object(r.useEffect)((function(){return function(){e({type:$})}}),[e]),n?Object(u.jsxs)("div",{className:"".concat(ge.a.card),children:[Object(u.jsx)("h3",{className:"".concat(ge.a.order," pt-3 text text_type_digits-large"),children:n}),Object(u.jsx)("p",{className:"text text_type_main-medium pt-1",children:"\u0418\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),Object(u.jsx)("span",{className:"".concat(ge.a.icon," mt-20 mb-20"),children:Object(u.jsx)(l.CheckMarkIcon,{type:"primary"})}),Object(u.jsx)("p",{className:"text text_type_main-default",children:"\u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043d\u0430\u0447\u0430\u043b\u0438 \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c"}),Object(u.jsx)("p",{className:"text text_type_main-default text_color_inactive pb-10 pt-2",children:"\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u0433\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u043e\u0440\u0431\u0438\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u0430\u043d\u0446\u0438\u0438"})]}):Object(u.jsx)(Oe,{})}var Ne=n(49),Ee=n.n(Ne);function Te(){var e=Object(f.h)(),t=Object(r.useState)(),n=Object(G.a)(t,2),a=n[0],c=n[1],s=h((function(e){return e.ingredients})),i=s.ingredientsData,o=s.isLoading,l=h((function(e){return e.ingredientDetails.activeIngredient}));return Object(r.useEffect)((function(){var t=e.pathname.split("/")[2];if(null===l){var n=i.find((function(e){return e._id===t}));if(n)return c(n)}null!==l&&c(l)}),[i,l,e.pathname]),o?Object(u.jsx)(Oe,{}):Object(u.jsxs)("div",{className:"".concat(Ee.a.card),children:[Object(u.jsx)("h3",{className:"mt-5 text text_type_main-large",children:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u0430"}),Object(u.jsx)("img",{className:"".concat(Ee.a.mainImage," mt-10"),src:null===a||void 0===a?void 0:a.image_large,alt:null===a||void 0===a?void 0:a.name}),Object(u.jsx)("p",{className:"".concat(Ee.a.name," pt-4 pb-6 text text_type_main-medium"),children:null===a||void 0===a?void 0:a.name}),Object(u.jsxs)("ul",{className:Ee.a.info,children:[Object(u.jsxs)("li",{children:[Object(u.jsx)("p",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u041a\u0430\u043b\u043e\u0440\u0438\u0438, \u043a\u043a\u0430\u043b"}),Object(u.jsx)("p",{className:"text text_type_digits-default text_color_inactive",children:null===a||void 0===a?void 0:a.calories})]}),Object(u.jsxs)("li",{children:[Object(u.jsx)("p",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0411\u0435\u043b\u043a\u0438, \u0433"}),Object(u.jsx)("p",{className:"text text_type_digits-default text_color_inactive",children:null===a||void 0===a?void 0:a.proteins})]}),Object(u.jsxs)("li",{children:[Object(u.jsx)("p",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0416\u0438\u0440\u044b, \u0433"}),Object(u.jsx)("p",{className:"text text_type_digits-default text_color_inactive",children:null===a||void 0===a?void 0:a.fat})]}),Object(u.jsxs)("li",{children:[Object(u.jsx)("p",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0423\u0433\u043b\u0435\u0432\u043e\u0434\u044b, \u0433"}),Object(u.jsx)("p",{className:"text text_type_digits-default text_color_inactive",children:null===a||void 0===a?void 0:a.carbohydrates})]})]})]})}var Se=n(87),Ce=n.n(Se),we=n(115),Ie=n.n(we);function Re(e){var t=e.onClose;return Object(u.jsx)("div",{className:Ie.a.modalOverlay,onClick:t})}function ke(e){var t=e.children,n=e.onClose,a=document.getElementById("react-modals");return Object(r.useEffect)((function(){var e=function(e){"Escape"===e.key&&n()};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}),[n]),s.a.createPortal(Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(Re,{onClose:n}),Object(u.jsxs)("div",{className:Ce.a.modal,children:[Object(u.jsx)("span",{onClick:n,className:Ce.a.modalCloseIcon,children:Object(u.jsx)(l.CloseIcon,{type:"primary"})}),t]})]}),a)}var De=n(116),Ae=n.n(De);function Le(){return Object(u.jsx)("p",{className:"text text_type_main-large ".concat(Ae.a.main),children:"404"})}var Ue=n(25),Ge=n(2),Pe=n(50),Be=n.n(Pe);function Qe(){var e=Object(f.g)(),t=x(),n=h((function(e){return e.user})),a=Object(r.useState)({email:"",password:""}),c=Object(G.a)(a,2),s=c[0],i=c[1],o=function(e){var t=e.currentTarget.value,n=e.currentTarget.name;i((function(e){return Object(Ge.a)(Object(Ge.a)({},e),{},Object(Ue.a)({},n,t))}))};return n.username?Object(u.jsx)(f.a,{to:{pathname:"/"}}):Object(u.jsxs)("div",{className:Be.a.main,children:[Object(u.jsx)("p",{className:"text text_type_main-large",children:"\u0412\u0445\u043e\u0434"}),Object(u.jsxs)("form",{onSubmit:function(n){n.preventDefault(),t(function(e){var t=e.email,n=e.password;return function(){var e=Object(v.a)(y.a.mark((function e(r){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:"LOGIN_REQUEST"}),a={method:"POST",body:JSON.stringify({email:t,password:n}),headers:{"Content-Type":"application/json"}},console.log("proceed to LOGIN"),e.next=5,fetch("https://norma.nomoreparties.space/api/auth/login",a).then((function(e){return C(e)})).then((function(e){N("accessToken",e.accessToken.split("Bearer ")[1]),localStorage.setItem("refreshToken",e.refreshToken),r({type:A,user:e.user}),r({type:"LOGIN_REQUEST_SUCCESS"})})).catch((function(e){console.error(e),r({type:"LOGIN_REQUEST_FAILED"})}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(s)),e.replace({pathname:"/"})},className:Be.a.form,children:[Object(u.jsx)(l.Input,{type:"text",placeholder:"E-mail",onChange:o,value:s.email,name:"email",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"}),Object(u.jsx)("div",{className:Be.a.formChild,children:Object(u.jsx)(l.PasswordInput,{onChange:o,value:s.password,name:"password"})}),Object(u.jsx)("div",{className:Be.a.formChild,children:Object(u.jsx)(l.Button,{type:"primary",size:"large",children:"\u0412\u043e\u0439\u0442\u0438"})})]}),Object(u.jsxs)("p",{className:"text text_type_main-default text_color_inactive",children:["\u0412\u044b \u2014 \u043d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c? ",Object(u.jsx)(d.b,{to:{pathname:"/register"},children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(u.jsxs)("p",{className:"text text_type_main-default text_color_inactive",children:["\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c? ",Object(u.jsx)(d.b,{to:{pathname:"/forgot-password"},children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"})]})]})}var Fe=n(63),ze=n.n(Fe),We="PASSWORD_FORGOT",Me="PASSWORD_FORGOT_RESTORE";function Ve(){var e=x(),t=Object(f.g)(),n=h((function(e){return e.user})),a=Object(r.useState)({email:""}),c=Object(G.a)(a,2),s=c[0],i=c[1];return n.username?Object(u.jsx)(f.a,{to:{pathname:"/"}}):Object(u.jsxs)("div",{className:ze.a.main,children:[Object(u.jsx)("p",{className:"text text_type_main-large",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f"}),Object(u.jsxs)("form",{onSubmit:function(n){n.preventDefault(),e({type:We}),e(function(e){var t=e.email;return function(){var e=Object(v.a)(y.a.mark((function e(n){var r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"FORGOT_PASSWORD_REQUEST"}),r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})},console.log("proceed to password forgot request"),e.next=5,fetch("https://norma.nomoreparties.space/api/password-reset",r).then((function(e){return C(e)})).then((function(e){console.log(e),n({type:"FORGOT_PASSWORD_REQUEST_SUCCESS"})})).catch((function(e){console.log(e),n({type:"FORGOT_PASSWORD_REQUEST_FAILED"})}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(s)),t.replace({pathname:"/reset-password"})},className:ze.a.form,children:[Object(u.jsx)(l.Input,{type:"text",placeholder:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 e-mail",onChange:function(e){var t=e.currentTarget.value,n=e.currentTarget.name;i((function(e){return Object(Ge.a)(Object(Ge.a)({},e),{},Object(Ue.a)({},n,t))}))},value:s.email,name:"email",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"}),Object(u.jsx)("div",{className:ze.a.formChild,children:Object(u.jsx)(l.Button,{type:"primary",size:"large",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"})})]}),Object(u.jsxs)("p",{className:"text text_type_main-default text_color_inactive",children:["\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c? ",Object(u.jsx)(d.b,{to:{pathname:"/login"},children:"\u0412\u043e\u0439\u0442\u0438"})]})]})}var He=n(23),Je=n.n(He),qe=function(){return function(){var e=Object(v.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"LOGOUT_REQUEST"}),n={method:"POST",body:JSON.stringify({token:localStorage.getItem("refreshToken")}),headers:{"Content-Type":"application/json"}},console.log("proceed to LOGOUT"),e.next=5,fetch("https://norma.nomoreparties.space/api/auth/logout",n).then((function(e){return C(e)})).then((function(){t({type:L}),N("accessToken",0,{expires:-1}),localStorage.removeItem("refreshToken"),t({type:"LOGOUT_REQUEST_SUCCESS"})})).catch((function(e){console.error(e),t({type:"LOGOUT_REQUEST_FAILED"})}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};function Ke(){var e=x(),t=h((function(e){return e.user})),n=Object(r.useState)({username:t.username,email:t.email,password:""}),a=Object(G.a)(n,2),c=a[0],s=a[1],i=Object(r.useRef)(null),o=Object(r.useState)(!1),m=Object(G.a)(o,2),j=m[0],p=m[1],b=Object(r.useCallback)((function(){e(qe())}),[e]);Object(r.useEffect)((function(){var e=function(e){var t;e.currentTarget&&null!==(t=i.current)&&void 0!==t&&t.contains(e.currentTarget)||p(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[]);var _=function(e){var t=e.currentTarget.value,n=e.currentTarget.name;s((function(e){return Object(Ge.a)(Object(Ge.a)({},e),{},Object(Ue.a)({},n,t))}))};return Object(u.jsxs)("div",{className:Je.a.main,ref:i,children:[Object(u.jsxs)("nav",{className:Je.a.nav,children:[Object(u.jsx)(d.c,{exact:!0,to:{pathname:"/profile"},activeClassName:Je.a.activeLink,className:"text text_type_main-large text-color-inactive ".concat(Je.a.navChild),children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),Object(u.jsx)(d.c,{exact:!0,to:{pathname:"/profile/orders"},activeClassName:Je.a.activeLink,className:"text text_type_main-large text-color-inactive ".concat(Je.a.navChild),children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),Object(u.jsx)(d.b,{onClick:b,to:{pathname:"/"},className:"text text_type_main-large text-color-inactive ".concat(Je.a.navChild),children:"\u0412\u044b\u0445\u043e\u0434"}),Object(u.jsx)("p",{className:"text text_type_main-small text_color_inactive ".concat(Je.a.navParagraph),children:"\u0412 \u044d\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0432\u043e\u0438 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"})]}),Object(u.jsxs)("form",{onSubmit:function(n){console.log(n),n.preventDefault(),"\u041e\u0442\u043c\u0435\u043d\u0430"===n.nativeEvent.submitter.outerText&&s((function(e){return Object(Ge.a)(Object(Ge.a)({},e),{},{username:t.username,email:t.email,password:""})})),"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"===n.nativeEvent.submitter.outerText&&e(function(e){var t=e.email,n=e.username,r=e.password;return function(){var e=Object(v.a)(y.a.mark((function e(a){var c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a({type:"PATCH_USER_DATA_REQUEST"}),c={method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer "+E("accessToken")},body:JSON.stringify({name:n,email:t,password:r})},console.log("proceed to PATCH user info"),e.next=5,I("https://norma.nomoreparties.space/api/auth/user",c).then((function(e){a({type:"PATCH_USER_DATA_REQUEST_SUCCESS",user:e.user})})).catch((function(e){console.error(e),a({type:"PATCH_USER_DATA_REQUEST_FAILED"})}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(c))},onClick:function(){p(!0)},className:Je.a.form,children:[Object(u.jsx)(l.Input,{type:"text",placeholder:"\u0418\u043c\u044f",onChange:_,value:c.username,name:"username",icon:"EditIcon",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"}),Object(u.jsx)("div",{className:Je.a.formChild,children:Object(u.jsx)(l.Input,{type:"text",placeholder:"\u041b\u043e\u0433\u0438\u043d",onChange:_,value:c.email,name:"email",icon:"EditIcon",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(u.jsx)("div",{className:Je.a.formChild,children:Object(u.jsx)(l.PasswordInput,{onChange:_,value:c.password,name:"password"})}),j&&Object(u.jsxs)("div",{className:Je.a.formChild,children:[Object(u.jsx)(l.Button,{type:"secondary",size:"medium",children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),Object(u.jsx)(l.Button,{type:"primary",size:"medium",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})]})}var Xe=n(38),Ye=n.n(Xe);function Ze(){var e=Object(f.g)(),t=x(),n=h((function(e){return e.user})),a=Object(r.useState)({username:"",email:"",password:""}),c=Object(G.a)(a,2),s=c[0],i=c[1],o=function(e){i((function(t){return Object(Ge.a)(Object(Ge.a)({},t),{},Object(Ue.a)({},e.currentTarget.name,e.currentTarget.value))}))};return n.username?Object(u.jsx)(f.a,{to:{pathname:"/"}}):Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{className:Ye.a.main,children:[Object(u.jsxs)("form",{onSubmit:function(n){n.preventDefault(),t(function(e){var t=e.username,n=e.email,r=e.password;return function(){var e=Object(v.a)(y.a.mark((function e(a){var c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a({type:"REGISTER_REQUEST"}),c={method:"POST",body:JSON.stringify({name:t,email:n,password:r}),headers:{"Content-Type":"application/json"}},console.log("proceed to REGISTRATION"),e.next=5,fetch("https://norma.nomoreparties.space/api/auth/register",c).then((function(e){return C(e)})).then((function(e){N("accessToken",e.accessToken.split("Bearer ")[1]),localStorage.setItem("refreshToken",e.refreshToken),a({type:A,user:e.user}),a({type:"REGISTER_REQUEST_SUCCESS"})})).catch((function(e){console.error(e),a({type:"REGISTER_REQUEST_FAILED"})}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(s)),e.replace({pathname:"/"})},className:Ye.a.form,children:[Object(u.jsx)("p",{className:"text text_type_main-large",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(u.jsx)("div",{className:Ye.a.formChild,children:Object(u.jsx)(l.Input,{type:"text",placeholder:"\u0418\u043c\u044f",onChange:o,value:s.username,name:"username",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(u.jsx)("div",{className:Ye.a.formChild,children:Object(u.jsx)(l.Input,{type:"text",placeholder:"E-mail",onChange:o,value:s.email,name:"email",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(u.jsx)("div",{className:Ye.a.formChild,children:Object(u.jsx)(l.PasswordInput,{onChange:o,value:s.password,name:"password"})}),Object(u.jsx)("div",{className:Ye.a.formChild,children:Object(u.jsx)(l.Button,{type:"primary",size:"large",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})})]}),Object(u.jsxs)("p",{className:"text text_type_main-default text_color_inactive",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",Object(u.jsx)(d.b,{to:{pathname:"/login"},children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})}var $e=n(51),et=n.n($e);function tt(){var e=Object(f.g)(),t=x(),n=h((function(e){return e.forgotPassword.isPasswordForgotten})),a=h((function(e){return e.user})),c=Object(r.useState)({password:"",token:""}),s=Object(G.a)(c,2),i=s[0],o=s[1],m=function(e){var t=e.currentTarget.value,n=e.currentTarget.name;o((function(e){return Object(Ge.a)(Object(Ge.a)({},e),{},Object(Ue.a)({},n,t))}))};return n?a.username?Object(u.jsx)(f.a,{to:{pathname:"/"}}):Object(u.jsxs)("div",{className:et.a.main,children:[Object(u.jsx)("p",{className:"text text_type_main-large",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f"}),Object(u.jsxs)("form",{onSubmit:function(n){n.preventDefault(),t({type:Me}),t(function(e){var t=e.password,n=e.token;return function(){var e=Object(v.a)(y.a.mark((function e(r){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:"RESET_PASSWORD_REQUEST"}),a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t,token:n})},console.log("proceed to password reset request"),e.next=5,fetch("https://norma.nomoreparties.space/api/password-reset",a).then((function(e){return C(e)})).then((function(e){console.log(e),r({type:"RESET_PASSWORD_REQUEST_SUCCESS"})})).catch((function(e){console.error(e),r({type:"RESET_PASSWORD_REQUEST_FAILED"})}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(i)),e.replace({pathname:"/login"})},className:et.a.form,children:[Object(u.jsx)(l.PasswordInput,{onChange:m,value:i.password,name:"password"}),Object(u.jsx)("div",{className:et.a.formChild,children:Object(u.jsx)(l.Input,{type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0438\u0437 \u043f\u0438\u0441\u044c\u043c\u0430",onChange:m,value:i.token,name:"token",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(u.jsx)("div",{className:et.a.formChild,children:Object(u.jsx)(l.Button,{type:"primary",size:"large",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})})]}),Object(u.jsxs)("p",{className:"text text_type_main-default text_color_inactive",children:["\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c? ",Object(u.jsx)(d.b,{to:{pathname:"/login"},children:"\u0412\u043e\u0439\u0442\u0438"})]})]}):Object(u.jsx)(f.a,{to:{pathname:"/"}})}var nt=n(27),rt=n.n(nt),at=n(28),ct=n.n(at),st=n(43),it=n.n(st);n(108);function ot(e){var t=e.onClick,n=e.order,a=e.from,c=h((function(e){return e.ingredients})),s=c.ingredientsData,i=Object(r.useState)([]),o=Object(G.a)(i,2),d=o[0],m=o[1],j=Object(r.useState)(!1),p=Object(G.a)(j,2),b=p[0],_=p[1],f=Object(r.useState)({value:"",color:""}),O=Object(G.a)(f,2),x=O[0],v=O[1],g=Object(r.useCallback)((function(e){if("done"!==e)if("created"!==e){if("pending"!==e)throw new Error("status value is not valid");v({value:"\u041e\u0442\u043c\u0435\u043d\u0435\u043d",color:"statusCancelled"})}else v({value:"\u0413\u043e\u0442\u043e\u0432\u0438\u0442\u0441\u044f",color:"statusInProgress"});else v({value:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d",color:"statusDone"})}),[]);return Object(r.useEffect)((function(){if(null!==n&&void 0!==n&&n.ingredients&&s){if(!n.status)throw new Error("something is wrong with order.status value");g(n.status);var e=[];n.ingredients.forEach((function(t){var n=s.find((function(e){return e._id===t}));void 0!==n&&e.push(n)})),d.length!==e.length&&(m([].concat(e)),_(!0))}}),[s,n.ingredients,d.length,n.status,g]),Object(u.jsx)("div",{className:ct.a.main,onClick:t,children:Object(u.jsxs)("span",{className:ct.a.content,children:[Object(u.jsxs)("span",{className:"".concat(ct.a.row," mt-3 mb-6"),children:[Object(u.jsx)("p",{className:"text text_type_digits-default",children:n.number}),Object(u.jsxs)("p",{className:"text text_type_main-default text_color_inactive",children:[it()(n.createdAt).calendar()," i-GMT+3"]})]}),Object(u.jsx)("p",{className:"text text_type_main-medium mb-4",children:n.name}),"profile"===a&&Object(u.jsx)("p",{className:"".concat(ct.a[x.color]," text text_type_main-default mb-4"),children:x.value}),Object(u.jsxs)("span",{className:"".concat(ct.a.row," mt-3 mb-5"),children:[Object(u.jsx)("span",{className:ct.a.icons,children:b?d.slice(0,6).map((function(e,t){return Object(u.jsxs)("span",{className:ct.a.ing,children:[d.length>6&&Object(u.jsxs)("span",{className:"text text_type_digits-default ".concat(ct.a.iconNumber),children:["+",d.length-6]}),Object(u.jsx)("img",{src:e.image_mobile,alt:"",className:"".concat(ct.a.ingIcons)})]},t)})):Object(u.jsx)(Oe,{})}),Object(u.jsxs)("span",{className:ct.a.value,children:[Object(u.jsx)("p",{className:"text text_type_digits-default mr-2",children:d.reduce((function(e,t){return e+t.price}),0)}),Object(u.jsx)(l.CurrencyIcon,{type:"primary"})]})]})]})})}var lt="WS_CONNECTION_START",dt="WS_CONNECTION_SUCCESS",ut="WS_CONNECTION_ERROR",mt="WS_CONNECTION_CLOSED",jt="WS_GET_MESSAGE",pt={wsInit:lt,wsSendMessage:"WS_SEND_MESSAGE",onOpen:dt,onClose:mt,onError:ut,onMessage:jt};function bt(){var e=Object(f.g)(),t=Object(f.h)(),n=x(),a=h((function(e){return e.ws.messages})),c=Object(r.useState)([]),s=Object(G.a)(c,2),i=s[0],o=s[1];Object(r.useEffect)((function(){return n({type:lt,wsUrl:S}),function(){n({type:mt})}}),[n]),Object(r.useEffect)((function(){var e=a[a.length-1];if(e){var t=JSON.parse(String(e));o((function(){return t.orders})),console.log(t.orders)}}),[a]);var l=Object(r.useCallback)((function(){n(qe())}),[n]);return Object(u.jsxs)("div",{className:rt.a.main,children:[Object(u.jsx)("div",{className:rt.a.left,children:Object(u.jsxs)("nav",{className:rt.a.nav,children:[Object(u.jsx)(d.c,{exact:!0,to:{pathname:"/profile"},activeClassName:rt.a.activeLink,className:"text text_type_main-medium text-color-inactive ".concat(rt.a.navChild),children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),Object(u.jsx)(d.c,{exact:!0,to:{pathname:"/profile/orders"},activeClassName:rt.a.activeLink,className:"text text_type_main-medium text-color-inactive ".concat(rt.a.navChild),children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),Object(u.jsx)(d.b,{onClick:l,to:{pathname:"/"},className:"text text_type_main-medium text-color-inactive ".concat(rt.a.navChild),children:"\u0412\u044b\u0445\u043e\u0434"}),Object(u.jsx)("p",{className:"text text_type_main-small text_color_inactive ".concat(rt.a.navParagraph),children:"\u0412 \u044d\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0432\u043e\u0438 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"})]})}),Object(u.jsx)("div",{className:rt.a.right,children:i?i.slice(0).reverse().map((function(r,a){return Object(u.jsx)(ot,{onClick:function(){return function(r){e.replace({pathname:"/profile/orders/".concat(r.number),state:{background:t,order:r}}),n({type:ne,value:!0})}(r)},order:r,from:"profile"},a)})):Object(u.jsx)(Oe,{})})]})}var _t=n(30),ft=n.n(_t),Ot=n(52),ht=n.n(Ot),xt=function(e){var t=e.quantity,n=e.period;if("today"===n)return Object(u.jsxs)("div",{className:ht.a.ordersToday,children:[Object(u.jsx)("p",{className:"text text_type_main-medium mb-3",children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f:"}),Object(u.jsx)("p",{className:"".concat(ht.a.ordersTodayNumber," text text_type_digits-large"),children:t})]});if("allTime"===n)return Object(u.jsxs)("div",{className:ht.a.ordersAllTime,children:[Object(u.jsx)("p",{className:"text text_type_main-medium mb-3",children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0432\u0441\u0435 \u0432\u0440\u0435\u043c\u044f:"}),Object(u.jsx)("p",{className:"".concat(ht.a.ordersAllTimeNumber," text text_type_digits-large"),children:t})]});throw new Error("Not correct period was given")},vt=n(53),gt=n.n(vt),yt=function(e){var t=e.ordersMarkup,n=e.status;if("done"===n)return Object(u.jsxs)("div",{className:gt.a.ordersReady,children:[Object(u.jsx)("p",{className:"text text_type_main-medium mb-5",children:"\u0413\u043e\u0442\u043e\u0432\u044b:"}),Object(u.jsx)("div",{className:gt.a.wrapper,children:t.length>0?t.map((function(e,t){return Object(u.jsx)("div",{className:"mr-3",children:e},t)})):Object(u.jsx)(Oe,{})})]});if("pending"===n)return Object(u.jsxs)("div",{className:gt.a.ordersPrep,children:[Object(u.jsx)("p",{className:"text text_type_main-medium mb-5",children:"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435:"}),Object(u.jsx)("div",{className:gt.a.wrapper,children:t.length>0?t.map((function(e,t){return Object(u.jsx)("div",{className:"mr-3",children:e},t)})):Object(u.jsxs)("div",{children:[Object(u.jsx)("p",{className:"text text_type_digits-default",children:"034523"},"1"),Object(u.jsx)("p",{className:"text text_type_digits-default",children:"034524"},"2"),Object(u.jsx)("p",{className:"text text_type_digits-default",children:"034525"},"3")]})})]});throw new Error("wrong status for FeedOrderNumbers component was given")};function Nt(){var e=Object(f.g)(),t=Object(f.h)(),n=x(),a=h((function(e){return e.ws.messages})),c=Object(r.useState)([]),s=Object(G.a)(c,2),i=s[0],o=s[1],l=Object(r.useState)(0),d=Object(G.a)(l,2),m=d[0],j=d[1],p=Object(r.useState)(0),b=Object(G.a)(p,2),_=b[0],O=b[1],v=Object(r.useState)([]),g=Object(G.a)(v,2),y=g[0],N=g[1],E=Object(r.useState)([]),T=Object(G.a)(E,2),S=T[0],C=T[1];Object(r.useEffect)((function(){return n({type:lt,wsUrl:"wss://norma.nomoreparties.space/orders/all"}),function(){n({type:mt})}}),[n]),Object(r.useEffect)((function(){var e=a[a.length-1];if(e){var t=JSON.parse(String(e));o(t.orders),j(t.total),O(t.totalToday)}}),[a]);var w=Object(r.useCallback)((function(e){for(var t=[],n=0;n<e.length;n+=10){var r=e.slice(n,n+10).map((function(e,t){return Object(u.jsx)("p",{className:"".concat(ft.a.ordersDone," text text_type_digits-default"),children:e},t)}));t.push(r)}return t}),[]);return Object(r.useEffect)((function(){if(i){var e=function(e,t){var n=i.filter((function(t){return t.status===e})).map((function(e){return e.number})),r=w(n);t(Object(P.a)(r))};e("done",N),e("process",C)}}),[i,w]),i?Object(u.jsxs)("div",{className:ft.a.main,children:[Object(u.jsx)("div",{className:ft.a.left,children:Object(u.jsxs)("div",{className:ft.a.orders,children:[Object(u.jsx)("p",{className:"".concat(ft.a.feedHeading," text text_type_main-large mb-6"),children:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),i.slice(0,12).map((function(r,a){return Object(u.jsx)(ot,{onClick:function(){return function(r){e.replace({pathname:"/feed/".concat(r.number),state:{background:t,order:r}}),n({type:ne,value:!0})}(r)},order:r,from:"feed"},a)}))]})}),Object(u.jsx)("div",{className:ft.a.right,children:Object(u.jsxs)("div",{className:ft.a.stats,children:[Object(u.jsxs)("div",{className:ft.a.ordersStats,children:[Object(u.jsx)(yt,{status:"done",ordersMarkup:y}),Object(u.jsx)(yt,{status:"pending",ordersMarkup:S})]}),Object(u.jsx)(xt,{period:"allTime",quantity:m}),Object(u.jsx)(xt,{period:"today",quantity:_})]})})]}):Object(u.jsx)(Oe,{})}var Et=n(16),Tt=n.n(Et);function St(e){var t=e.order,n=e.modal,a=Object(f.h)(),c=x(),s=h((function(e){return e.ingredients})),i=s.ingredientsData,o=Object(r.useState)([]),d=Object(G.a)(o,2),m=d[0],j=d[1],p=Object(r.useState)(),b=Object(G.a)(p,2),_=b[0],O=b[1],g=Object(r.useState)(!1),N=Object(G.a)(g,2),E=N[0],T=N[1],S=Object(r.useState)({value:"",color:""}),w=Object(G.a)(S,2),I=w[0],R=w[1],k=Object(r.useCallback)((function(e){if("done"!==e)if("created"!==e){if("pending"!==e)throw new Error("status value is not valid");R({value:"\u041e\u0442\u043c\u0435\u043d\u0435\u043d",color:"statusCancelled"})}else R({value:"\u0413\u043e\u0442\u043e\u0432\u0438\u0442\u0441\u044f",color:"statusInProgress"});else R({value:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d",color:"statusDone"})}),[]),D=h((function(e){return e.orderDetails.order})),A=Object(r.useCallback)((function(e){var t=[];e.ingredients.forEach((function(e){var n=i.find((function(t){return t._id===e}));void 0!==n&&t.push(n)})),m.length!==t.length&&(j([].concat(Object(P.a)(m),t)),T(!0))}),[i,m]),L=Object(r.useCallback)((function(){var e=a.pathname;if(e.startsWith("/profile/orders/"))return e.split("/")[3];if(e.startsWith("/feed/"))return e.split("/")[2];throw new Error("location.pathname is not in orders or feed")}),[a.pathname]);return Object(r.useEffect)((function(){if(t)O((function(e){return Object(Ge.a)(Object(Ge.a)({},e),t)})),A(t),k(t.status);else{var e=L();c(function(e){return function(){var t=Object(v.a)(y.a.mark((function t(n){var r;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:X}),r={method:"GET",headers:{"Content-Type":"application/json"}},t.next=4,fetch("".concat("https://norma.nomoreparties.space/api/orders","/").concat(e),r).then((function(e){return C(e)})).then((function(e){n({type:Y,order:e.orders[0]})})).catch((function(e){n({type:K}),console.log(e)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(e))}}),[t,c,A,k,L]),Object(r.useEffect)((function(){t||0===Object.keys(D).length||(O((function(e){return Object(Ge.a)(Object(Ge.a)({},e),D)})),A(D),k(D.status))}),[t,D,A,k]),_?Object(u.jsxs)("div",{className:n?Tt.a.mainModal:Tt.a.main,children:[Object(u.jsxs)("p",{className:"".concat(Tt.a.orderNumber," text text_type_digits-medium mb-10"),children:["#",_.number]}),Object(u.jsx)("p",{className:" ".concat(Tt.a.orderName," text text_type_main-medium mb-5"),children:_.name}),Object(u.jsx)("p",{className:"".concat(Tt.a[I.color]," text text_type_main-default mb-15"),children:I.value}),Object(u.jsxs)("div",{className:" ".concat(Tt.a.orderContent," "),children:[Object(u.jsx)("p",{className:"text text_type_main-medium mb-7",children:"\u0421\u043e\u0441\u0442\u0430\u0432:"}),Object(u.jsx)("div",{className:" ".concat(Tt.a.orderIngredients," "),children:E?m.map((function(e,t){return Object(u.jsxs)("div",{className:" ".concat(Tt.a.orderIngredientRow," mb-1"),children:[Object(u.jsx)("div",{className:Tt.a.ingIconSpan,children:Object(u.jsx)("img",{src:e.image_mobile,alt:"",className:"".concat(Tt.a.ingIcon)})}),Object(u.jsx)("p",{className:"".concat(Tt.a.ingName," text text_type_main-default"),children:e.name}),Object(u.jsxs)("span",{className:Tt.a.ingValue,children:[Object(u.jsxs)("p",{className:"text text_type_digits-default mr-3",children:["1x ",e.price]}),Object(u.jsx)(l.CurrencyIcon,{type:"primary"})]})]},t)})):Object(u.jsx)(Oe,{})})]}),Object(u.jsxs)("span",{className:"".concat(Tt.a.row," mt-10"),children:[Object(u.jsxs)("p",{className:"".concat(Tt.a.orderDate," text text_type_main-default text_color_inactive"),children:[it()(_.createdAt).calendar()," i-GMT+3"]}),Object(u.jsxs)("span",{className:Tt.a.orderValue,children:[Object(u.jsx)("p",{className:"text text_type_digits-default mr-3",children:m.reduce((function(e,t){return e+t.price}),0)}),Object(u.jsx)(l.CurrencyIcon,{type:"primary"})]})]})]}):Object(u.jsx)(Oe,{})}var Ct=n(117),wt=["children"];function It(e){var t=e.children,n=Object(Ct.a)(e,wt),a=x(),c=Object(r.useState)(!1),s=Object(G.a)(c,2),i=s[0],o=s[1],l=h((function(e){return e.user})),d=Object(r.useCallback)(Object(v.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(U());case 2:o(!0);case 3:case"end":return e.stop()}}),e)}))),[a]);return Object(r.useEffect)((function(){d()}),[d]),i?i?Object(u.jsx)(f.b,Object(Ge.a)(Object(Ge.a)({},n),{},{render:function(e){var n=e.location;return l.username?t:Object(u.jsx)(f.a,{to:{pathname:"/login",state:{from:n}}})}})):Object(u.jsx)(Oe,{}):null}function Rt(){var e,t=x(),n=Object(f.g)(),a=Object(f.h)(),c=null===(e=a.state)||void 0===e?void 0:e.background,s=h((function(e){return e.modals})),i=s.visibleOrderDetails;Object(r.useEffect)((function(){t(function(){var e=Object(v.a)(y.a.mark((function e(t){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:R}),e.prev=1,e.next=4,fetch("https://norma.nomoreparties.space/api/ingredients");case 4:return n=e.sent,e.next=7,C(n);case 7:r=e.sent,t({type:k,payload:r.data}),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),t({type:D}),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()),t(U())}),[t]);var o=function(){t({type:ee,value:!1}),t({type:te,value:!1}),c&&n.replace({pathname:c.pathname})};return console.log(a),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)(f.d,{location:c||a,children:[Object(u.jsx)(f.b,{path:"/register",children:Object(u.jsx)(Ze,{})}),Object(u.jsx)(f.b,{path:"/login",children:Object(u.jsx)(Qe,{})}),Object(u.jsx)(f.b,{path:"/forgot-password",children:Object(u.jsx)(Ve,{})}),Object(u.jsx)(f.b,{path:"/reset-password",children:Object(u.jsx)(tt,{})}),Object(u.jsx)(f.b,{exact:!0,path:"/ingredients/:id",children:Object(u.jsx)(Te,{})}),Object(u.jsx)(f.b,{exact:!0,path:"/feed",children:Object(u.jsx)(Nt,{})}),Object(u.jsx)(f.b,{path:"/feed/:id",children:Object(u.jsx)(St,{})}),Object(u.jsx)(It,{exact:!0,path:"/profile",children:Object(u.jsx)(Ke,{})}),Object(u.jsx)(It,{exact:!0,path:"/profile/orders",children:Object(u.jsx)(bt,{})}),Object(u.jsx)(It,{path:"/profile/orders/:id",children:Object(u.jsx)(St,{})}),Object(u.jsxs)(f.b,{exact:!0,path:"/",children:[Object(u.jsx)("main",{className:p.a.main,children:Object(u.jsxs)(b.a,{backend:_.a,children:[Object(u.jsx)(xe,{}),Object(u.jsx)(de,{})]})}),i&&Object(u.jsx)(ke,{onClose:o,children:Object(u.jsx)(ye,{})})]}),Object(u.jsx)(f.b,{children:Object(u.jsx)(Le,{})})]}),c&&Object(u.jsx)(f.b,{exact:!0,path:"/ingredients/:id",children:Object(u.jsx)(ke,{onClose:o,children:Object(u.jsx)(Te,{})})}),c&&Object(u.jsx)(f.b,{exact:!0,path:"".concat(c.pathname,"/:id"),children:Object(u.jsx)(ke,{onClose:o,children:Object(u.jsx)(St,{modal:!0,order:a.state.order})})})]})}function kt(){return Object(u.jsxs)(d.a,{children:[Object(u.jsx)(m,{}),Object(u.jsx)(Rt,{})]})}var Dt=n(121),At=n(35),Lt=n(118),Ut=n.n(Lt),Gt={"\u0441artIngredients":[],bunIngredients:[]},Pt={ingredientsData:[],isLoading:!1,hasError:!1},Bt={visibleOrderDetails:!1,visibleIngredientDetails:!1,visibleOrdersDetails:!1},Qt={activeIngredient:null},Ft={ingredientsIDs:[],orderNumber:null,isLoading:!1,hasError:!1,order:{}},zt={isPasswordForgotten:!1},Wt={username:"",email:""},Mt={wsConnected:!1,messages:[]},Vt=n(119),Ht=n(120),Jt=n.n(Ht),qt=Object(Vt.composeWithDevTools)(Object(At.applyMiddleware)(Jt.a,Dt.a,function(e){return function(t){var n=null;return function(r){return function(a){var c=t.dispatch,s=e.wsInit,i=e.wsSendMessage,o=e.onOpen,l=e.onClose,d=e.onError,u=e.onMessage;if(a.type===s&&void 0!==a.wsUrl&&(n=new WebSocket(a.wsUrl)),n&&(n.onopen=function(e){c({type:o,payload:e})},n.onerror=function(e){c({type:d,payload:e})},n.onmessage=function(e){var t=e.data;c({type:u,payload:t})},n.onclose=function(e){c({type:l,payload:e})},a.type===i)){var m=a.payload;n.send(JSON.stringify(m))}r(a)}}}}(pt))),Kt=Object(At.combineReducers)({ingredients:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return Object(Ge.a)(Object(Ge.a)({},e),{},{isLoading:!0});case k:return Object(Ge.a)(Object(Ge.a)({},e),{},{ingredientsData:t.payload,isLoading:!1});case D:return Object(Ge.a)(Object(Ge.a)({},e),{},{isLoading:!1,hasError:!0});default:return e}},modals:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ee:return Object(Ge.a)(Object(Ge.a)({},e),{},{visibleOrderDetails:t.value});case te:return Object(Ge.a)(Object(Ge.a)({},e),{},{visibleIngredientDetails:t.value});case ne:return Object(Ge.a)(Object(Ge.a)({},e),{},{visibleOrdersDetails:t.value});default:return e}},ingredientDetails:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qt,t=arguments.length>1?arguments[1]:void 0;return t.type===he?Object(Ge.a)(Object(Ge.a)({},e),{},{activeIngredient:t.activeIngredient}):e},orderDetails:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ft,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J:return Object(Ge.a)(Object(Ge.a)({},e),{},{isLoading:!0});case q:return Object(Ge.a)(Object(Ge.a)({},e),{},{isLoading:!1,orderNumber:t.orderNumber,ingredientsIDs:t.ingredientsIDs});case K:return Object(Ge.a)(Object(Ge.a)({},e),{},{isLoading:!1,hasError:!0});case X:return Object(Ge.a)(Object(Ge.a)({},e),{},{isLoading:!0});case Y:return Object(Ge.a)(Object(Ge.a)({},e),{},{isLoading:!1,order:t.order});case Z:return Object(Ge.a)(Object(Ge.a)({},e),{},{isLoading:!1,hasError:!0});case $:return Object(Ge.a)(Object(Ge.a)({},e),{},{orderNumber:null});default:return e}},cart:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z:return Object(Ge.a)(Object(Ge.a)({},e),{},{"\u0441artIngredients":[].concat(Object(P.a)(e.\u0441artIngredients),[t.ingredient])});case W:return Object(Ge.a)(Object(Ge.a)({},e),{},{bunIngredients:[t.ingredient]});case V:return Object(Ge.a)(Object(Ge.a)({},e),{},{"\u0441artIngredients":Ut()(e.\u0441artIngredients,{$splice:[[t.ingredient.index,1],[t.dropIndex,0,t.ingredient.item]]})});case M:return Object(Ge.a)(Object(Ge.a)({},e),{},{"\u0441artIngredients":e.\u0441artIngredients.filter((function(e,n){return n!==t.ingredientIndex}))});case H:return Gt;default:return e}},forgotPassword:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case We:return Object(Ge.a)(Object(Ge.a)({},e),{},{isPasswordForgotten:!0});case Me:return Object(Ge.a)(Object(Ge.a)({},e),{},{isPasswordForgotten:!1});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A:return Object(Ge.a)(Object(Ge.a)({},e),{},{email:t.user.email,username:t.user.name});case L:return Wt;default:return e}},ws:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case dt:return Object(Ge.a)(Object(Ge.a)({},e),{},{error:void 0,wsConnected:!0});case ut:return Object(Ge.a)(Object(Ge.a)({},e),{},{error:t.payload,wsConnected:!1});case mt:return Object(Ge.a)(Object(Ge.a)({},e),{},{error:void 0,wsConnected:!1});case jt:return Object(Ge.a)(Object(Ge.a)({},e),{},{error:void 0,messages:[].concat(Object(P.a)(e.messages),[t.payload])});default:return e}}}),Xt=Object(At.createStore)(Kt,qt);s.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(O.a,{store:Xt,children:Object(u.jsx)(kt,{})})}),document.getElementById("root"))},23:function(e,t,n){e.exports={main:"profile_main__oGT78",nav:"profile_nav__3iado",navChild:"profile_navChild__3idbP",navParagraph:"profile_navParagraph__1_jKt",activeLink:"profile_activeLink__1U0lF",form:"profile_form__2tNte",formChild:"profile_formChild__1J3LJ"}},27:function(e,t,n){e.exports={main:"profile-orders_main__2ZClL",left:"profile-orders_left__1KDs_",right:"profile-orders_right__IFHgx",nav:"profile-orders_nav__2gwdO",navChild:"profile-orders_navChild__mhzXA",navParagraph:"profile-orders_navParagraph__3QbMj",activeLink:"profile-orders_activeLink__2khmv"}},28:function(e,t,n){e.exports={main:"order-element_main__24UEc",content:"order-element_content__3LBzv",row:"order-element_row__2ws1q",icons:"order-element_icons__l7zz7",ing:"order-element_ing__2VtVx",iconNumber:"order-element_iconNumber__3NNHu",ingIcons:"order-element_ingIcons__l4v8j",value:"order-element_value__zC6kp",statusDone:"order-element_statusDone__Wkkzb",statusCancelled:"order-element_statusCancelled__3wyDy",statusInProcess:"order-element_statusInProcess__thHQI"}},30:function(e,t,n){e.exports={main:"feed_main__2ol7x",left:"feed_left__3wVh1",right:"feed_right__E721i",orders:"feed_orders__3yrtM",feedHeading:"feed_feedHeading__1tk2R",stats:"feed_stats__2Aq3N",ordersStats:"feed_ordersStats__3BoSo",ordersReady:"feed_ordersReady__1ykCe",ordersPrep:"feed_ordersPrep__3pSmm",ordersAllTime:"feed_ordersAllTime__3hyol",ordersAllTimeNumber:"feed_ordersAllTimeNumber__1Yv1b",ordersToday:"feed_ordersToday__5v4x5",ordersTodayNumber:"feed_ordersTodayNumber__1aa20",ordersDone:"feed_ordersDone__3wZs2",wrapper:"feed_wrapper__7xKPn"}},36:function(e,t,n){e.exports={main:"burger-constructor_main__3KXdU",constructor:"burger-constructor_constructor__IvB1z",middle:"burger-constructor_middle__1iDXk",middleIngredients:"burger-constructor_middleIngredients__7O5b9",dragIcon:"burger-constructor_dragIcon__11cWl",orderSection:"burger-constructor_orderSection__3syKX",price:"burger-constructor_price___Wnow"}},37:function(e,t,n){e.exports={main:"burger-ingredients_main__2oe95",ingredientsTypeBar:"burger-ingredients_ingredientsTypeBar__rhkYD",ingredientsTabs:"burger-ingredients_ingredientsTabs__13Uf9",ingredientsTabsElement:"burger-ingredients_ingredientsTabsElement__3hcRI"}},38:function(e,t,n){e.exports={main:"register_main__1gWGj",form:"register_form__1oY_e",formChild:"register_formChild__IA-MX"}},49:function(e,t,n){e.exports={card:"ingredient-details_card__3N5us",order:"ingredient-details_order__3ot29",info:"ingredient-details_info__aSogH"}},50:function(e,t,n){e.exports={main:"login_main__D0G6T",form:"login_form__b66Ct",formChild:"login_formChild__3HfPa"}},51:function(e,t,n){e.exports={main:"reset-password_main__mW9Mj",form:"reset-password_form__2tSd4",formChild:"reset-password_formChild__3FpLF"}},52:function(e,t,n){e.exports={ordersAllTime:"feed-order-numbers-overall_ordersAllTime__2TWF7",ordersAllTimeNumber:"feed-order-numbers-overall_ordersAllTimeNumber__1UM2u",ordersToday:"feed-order-numbers-overall_ordersToday__2xh4E",ordersTodayNumber:"feed-order-numbers-overall_ordersTodayNumber__29zfh"}},53:function(e,t,n){e.exports={wrapper:"feed-order-numbers_wrapper__2kAlG",ordersReady:"feed-order-numbers_ordersReady__1SaO_",ordersPrep:"feed-order-numbers_ordersPrep__1I4MY"}},62:function(e,t,n){e.exports={card:"order-details_card__3gLqv",icon:"order-details_icon__3fBCQ",order:"order-details_order__FlpZV"}},63:function(e,t,n){e.exports={main:"forgot-password_main__1HCzu",form:"forgot-password_form__1-YyM",formChild:"forgot-password_formChild__3CXmB"}},85:function(e,t,n){e.exports={card:"burger-ingredients-card_card__10tVf",price:"burger-ingredients-card_price__3VBAC",center:"burger-ingredients-card_center__2nqGD"}},86:function(e,t,n){e.exports={main:"loader_main__FLXAs",loader:"loader_loader__2d6FG"}},87:function(e,t,n){e.exports={modal:"modal_modal__2bhYs",modalCloseIcon:"modal_modalCloseIcon__1GWLO"}}},[[216,1,2]]]);
//# sourceMappingURL=main.b3438e1f.chunk.js.map